# Default values for istaroth.

# Backend configuration
backend:
  replicaCount: 1
  image:
    repository: isundaylee/istaroth
    tag: latest
    pullPolicy: Always

  service:
    type: ClusterIP
    port: 8000

  resources:
    limits:
      cpu: 2000m
      memory: 4Gi
    requests:
      cpu: 500m
      memory: 1Gi

  # Environment variables - supports both direct values and valueFrom references
  env:
    - name: ISTAROTH_DOCUMENT_STORE_SET
      value: "CHS:/data/checkpoint_web/chs,ENG:/data/checkpoint_web/eng"
    - name: ISTAROTH_DOWNLOAD_CHECKPOINT_RELEASE
      value: "1"
    - name: ISTAROTH_AVAILABLE_MODELS
      value: "all"
    - name: ISTAROTH_QUERY_TRANSFORMER
      value: "rewrite"
    - name: ISTAROTH_RERANKER
      value: "cohere"
    # Example: Database URI from secret
    # - name: ISTAROTH_DATABASE_URI
    #   valueFrom:
    #     secretKeyRef:
    #       name: db-credentials
    #       key: database-uri

    # Secrets are managed via SealedSecrets
    # Create a SealedSecret that generates a Secret named: {release-name}-secret

  probes:
    liveness:
      httpGet:
        path: /api/models
        port: 8000
      initialDelaySeconds: 30
      periodSeconds: 10
    readiness:
      httpGet:
        path: /api/models
        port: 8000
      initialDelaySeconds: 5
      periodSeconds: 5

# Frontend configuration
frontend:
  replicaCount: 1
  image:
    repository: isundaylee/istaroth-frontend
    tag: latest
    pullPolicy: Always

  service:
    type: ClusterIP
    port: 80

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  env: {}

  probes:
    liveness:
      httpGet:
        path: /
        port: 80
      initialDelaySeconds: 10
      periodSeconds: 10
      failureThreshold: 20
    readiness:
      httpGet:
        path: /
        port: 80
      initialDelaySeconds: 5
      periodSeconds: 5

# Persistent storage configuration for backend application data
persistence:
  storageClass: ""  # Leave empty to use default storage class
  accessMode: ReadWriteOnce
  size: 10Gi


# Service configuration
service:
  type: ClusterIP
  annotations: {}

# Ingress configuration
ingress:
  enabled: false
  className: traefik
  annotations: {}
  hosts:
    - host: istaroth.example.com

# Pod security context
podSecurityContext: {}

# Container security context
containerSecurityContext: {}

# Additional labels
labels: {}

# Additional annotations
annotations: {}

# Extra manifests (e.g., for SealedSecrets)
extraManifests: []
  # Example: To inject a SealedSecret, add it to extraManifests like this:
  # - |
  #   apiVersion: bitnami.com/v1alpha1
  #   kind: SealedSecret
  #   metadata:
  #     name: {{ .Release.Name }}-secret
  #     namespace: {{ .Release.Namespace }}
  #   spec:
  #     secretName: {{ .Release.Name }}-secret
  #     encryptedData:
  #       LANGSMITH_API_KEY: AgBy3RTqp8sQKJ+QKZw...
  #       LANGSMITH_PROJECT: AgBxY8mQK+QKZw...
  #       LANGSMITH_TRACING: AgCdXRTqp8sQKJ...
  #       GOOGLE_API_KEY: AgD9Y8mQK+QKZw...
  #       CO_API_KEY: AgE1RTqp8sQKJ...
  #       OPENAI_API_KEY: AgF5Y8mQK+QKZw...
